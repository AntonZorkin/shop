import{a as p,i as d}from"./vendor-4yCzdkXl.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();const r={categoriesElem:document.querySelector(".categories"),productsElem:document.querySelector(".products"),loadMoreElem:document.querySelector(".load-more-btn"),modalElem:document.querySelector(".modal-product"),modalRoot:document.querySelector(".modal"),modalCloseElem:document.querySelector(".modal__close-btn"),formElem:document.querySelector(".search-form"),inputElem:document.querySelector(".search-form__input"),themeElem:document.querySelector(".theme-toggle-btn"),cartNumElem:document.querySelector(".js-cart-count"),wishNumElem:document.querySelector(".js-wish-count"),cartProducts:document.querySelector(".js-cart-products"),wishProducts:document.querySelector(".js-wish-products")},M=e=>e.map(t=>`<li class="categories__item">
   <button class="categories__btn" type="button">${t}</button>
 </li>`).join(""),h=e=>e.map(t=>`
  <li class="products__item" data-id="${t.id}">
    <img class="products__image" src="${t.thumbnail}" alt="${t.description}"/>
    <p class="products__title">${t.title}</p>
    <p class="products__brand"><span class="products__brand--bold">Brand:${t.brand}</span></p>
    <p class="products__category">Category: ${t.category}</p>
    <p class="products__price">Price: ${t.price}$</p>
  </li>`).join(""),T=e=>{var t;return`<img class="modal-product__img" src="${((t=e.images)==null?void 0:t[0])??e.thumbnail}" alt="${e.title||"Product image"}" />
      <div class="modal-product__content">
        <p class="modal-product__title">${e.title}</p>
        <ul class="modal-product__tags">${e.tags}</ul>
        <p class="modal-product__description">${e.description}</p>
        <p class="invisible js-product-id">${e.id}</p>
        <p class="modal-product__shipping-information">Shipping: ${e.shippingInformation}</p>
        <p class="modal-product__return-policy">Return Policy: ${e.returnPolicy}</p>
        <p class="modal-product__price">Price: ${e.price}$</p>
        <button class="modal-product__buy-btn js-buy-btn" type="button">Buy</button>
      </div>`},x="https://dummyjson.com/",f={CATEGORIES:"products/category-list",PRODUCTS:"products?",CATEGORY:"products/category/",ID:"products/",NAME:"products/search?q="},u=12;let g="All";const O=()=>{const e=document.querySelector(".categories__btn");e&&(e.classList.add("categories__btn--active"),g=e.textContent)},R=e=>{const t=e.target.closest(".categories__btn");if(!t)return;const o=document.querySelector(".categories__btn--active");o&&o.classList.remove("categories__btn--active"),t.classList.add("categories__btn--active"),g=t.textContent},S=()=>{y>m?r.loadMoreElem.classList.remove("is-hidden"):r.loadMoreElem.classList.add("is-hidden")};p.defaults.baseURL=x;async function A(){try{return(await p.get(`${f.CATEGORIES}`)).data}catch(e){throw e}}let y;async function P(){let e=new URLSearchParams({limit:u,skip:(m-1)*u});try{const o=(await p.get(`${f.CATEGORY}${g}`,{params:e})).data;return y=Math.ceil(o.total/u),o.products}catch(t){throw t}}async function w(){let e=new URLSearchParams({limit:u,skip:(m-1)*u});try{const o=(await p.get(`${f.PRODUCTS}`,{params:e})).data;return y=Math.ceil(o.total/u),o.products}catch(t){throw t}}const C=async e=>{try{return(await p.get(`${f.ID}${e}`)).data}catch(t){throw t}},B=async e=>{let t=new URLSearchParams({limit:u,skip:(m-1)*u});try{const c=(await p.get(`${f.NAME}${e}`,{params:t})).data;return y=Math.ceil(c.total/u),c.products}catch(o){throw o}},n=e=>{let t=localStorage.getItem(e);if(t===null||t==="")return localStorage.setItem(e,"[]"),[];try{return t=JSON.parse(localStorage.getItem(e)),Array.isArray(t)?t:[]}catch{return localStorage.setItem(e,"[]"),[]}},J=e=>{const t=n("cart");t.includes(String(e))||(t.push(String(e)),localStorage.setItem("cart",JSON.stringify(t)))},F=e=>{const o=n("wishlist").filter(c=>String(c)!==String(e));localStorage.setItem("wishlist",JSON.stringify(o))},$=()=>{let e=localStorage.getItem("theme");e||(localStorage.setItem("theme","light"),e="light"),e==="dark"?document.body.setAttribute("data-theme","dark"):document.body.removeAttribute("data-theme")};r.modalElem.addEventListener("click",e=>{e.target.closest(".js-buy-btn")&&W()});function q(){r.modalRoot.classList.add("modal--is-open"),document.addEventListener("keydown",N),r.modalRoot.addEventListener("click",k)}const v=()=>{r.modalRoot.classList.remove("modal--is-open"),document.removeEventListener("keydown",N),r.modalRoot.removeEventListener("click",k),delete r.modalRoot.dataset.id},N=e=>{r.modalRoot.classList.contains("modal--is-open")&&e.key==="Escape"&&v()},k=e=>{e.target===e.currentTarget&&v()},W=()=>{const e=r.modalRoot.dataset.id;if(!e)return;let t=n("cart");if(t.includes(e)){const c=t.indexOf(e);t.splice(c,1),localStorage.setItem("cart",JSON.stringify(t)),localStorage.setItem("cartCount",String(t.length))}let o=n("wishlist");if(o.includes(e)){const c=o.indexOf(e);o.splice(c,1),localStorage.setItem("wishlist",JSON.stringify(o)),localStorage.setItem("wishlistCount",String(o.length))}d.success({message:"Purchase successful.",timeout:3e3,position:"topCenter"}),v()};let m=1;const D=async()=>{let e=localStorage.getItem("cart");e===null||e===""?(localStorage.setItem("cart","[]"),localStorage.setItem("cartCount","0"),r.cartNumElem.textContent=0):(localStorage.setItem("cartCount",JSON.parse(localStorage.getItem("cart")).length),r.cartNumElem.textContent=localStorage.getItem("cartCount"));let t=localStorage.getItem("wishlist");t===null||t===""?(localStorage.setItem("wishlist","[]"),localStorage.setItem("wishlistCount","0"),r.wishNumElem.textContent=0):(localStorage.setItem("wishlistCount",JSON.parse(localStorage.getItem("wishlist")).length),r.wishNumElem.textContent=localStorage.getItem("wishlistCount")),$();const o=await A(),c=M(["All",...o]);r.categoriesElem.innerHTML=c,O();const s=await w(),a=h(s);r.productsElem.innerHTML=a,S()},U=async e=>{R(e),m=1;try{const t=g==="All"?await w():await P();r.productsElem.innerHTML=h(t),S()}catch(t){throw t}},G=async e=>{m+=1;try{let t;g&&g!=="All"?t=await P():t=await w();const o=h(t);r.productsElem.insertAdjacentHTML("beforeend",o),S(),m>=y&&d.info({message:"No more products available.",timeout:3e3,position:"topCenter",color:"yellow"})}catch(t){throw t}};let i;const K=async e=>{const t=e.target.closest(".products__item");if(t)try{const o=Number(t.dataset.id),c=await C(o);r.modalElem.innerHTML=T(c),r.modalRoot.dataset.id=String(c.id),q();const s=r.modalRoot.querySelector(".js-cart-btn");i=String(c.id),n("cart").includes(i)?(s.textContent="Remove from cart",s.classList.add("in-cart"),s.addEventListener("click",L)):(s.textContent="Add to cart",s.addEventListener("click",I));const l=r.modalRoot.querySelector(".js-wish-btn");n("wishlist").includes(i)?(l.textContent="Remove from Wishlist",l.classList.add("in-wishlist"),l.addEventListener("click",_)):(l.textContent="Add to Wishlist",l.addEventListener("click",E))}catch(o){throw o}},I=e=>{const t=e.currentTarget;let o=n("cart");o.includes(i)||(o.push(i),t.textContent="Remove from cart",t.classList.add("in-cart"),t.removeEventListener("click",I),t.addEventListener("click",L)),localStorage.setItem("cart",JSON.stringify(o)),r.cartNumElem.textContent=o.length,localStorage.setItem("cartCount",String(o.length))},E=e=>{const t=e.currentTarget;let o=n("wishlist");o.includes(i)||(o.push(i),t.textContent="Remove from Wishlist",t.classList.add("in-wishlist"),t.removeEventListener("click",E),t.addEventListener("click",_)),r.wishNumElem.textContent=o.length,localStorage.setItem("wishlist",JSON.stringify(o)),localStorage.setItem("wishlistCount",String(o.length))},L=e=>{const t=e.currentTarget;let o=n("cart");if(o.includes(i)){const c=o.indexOf(i);o.splice(c,1),t.textContent="Add to cart",t.classList.remove("in-cart"),t.removeEventListener("click",L),t.addEventListener("click",I)}localStorage.setItem("cart",JSON.stringify(o)),r.cartNumElem.textContent=o.length,localStorage.setItem("cartCount",String(o.length))},_=e=>{const t=e.currentTarget;let o=n("wishlist");if(o.includes(i)){const c=o.indexOf(i);o.splice(c,1),t.textContent="Add to Wishlist",t.classList.remove("in-wishlist"),t.removeEventListener("click",_),t.addEventListener("click",E)}localStorage.setItem("wishlist",JSON.stringify(o)),r.wishNumElem.textContent=o.length,localStorage.setItem("wishlistCount",String(o.length))};let b;const Y=async e=>{e.preventDefault(),b=r.inputElem.value.trim();const t=await B(b);t.length===0&&d.info({message:"No products found.",timeout:3e3,position:"topCenter",color:"yellow"});const o=h(t);r.productsElem.innerHTML=o},z=e=>{const t=localStorage.getItem("theme");t||localStorage.setItem("theme","light"),t==="light"?(document.body.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.body.removeAttribute("data-theme"),localStorage.setItem("theme","light"))},Q=async()=>{let e=n("cart");if(Array.isArray(e)||(e=[]),e.length===0){d.info({message:"Cart is empty",timeout:3e3,position:"topCenter",color:"yellow"}),r.cartProducts.innerHTML="";return}e=e.map(s=>Number(s)).filter(s=>Number.isFinite(s));let t=[];for(let s=0;s<e.length;s++)t.push(C(e[s]));t=await Promise.allSettled(t);const o=[];for(let s=0;s<t.length;s++){const a=t[s];a.status==="fulfilled"?o.push(a.value):d.warning({message:"Failed to load product",timeout:3e3,position:"topCenter",color:"red"})}if(o.length===0){d.info({message:"Cart is empty",timeout:3e3,position:"topCenter",color:"yellow"}),r.cartProducts.innerHTML="";return}const c=h(o);r.cartProducts.innerHTML=c},V=async()=>{let e=n("wishlist");if(Array.isArray(e)||(e=[]),e.length===0){d.info({message:"Wishlist is empty",timeout:3e3,position:"topCenter",color:"yellow"}),r.wishProducts.innerHTML="";return}e=e.map(s=>Number(s)).filter(s=>Number.isFinite(s));let t=[];for(let s=0;s<e.length;s++)t.push(C(e[s]));t=await Promise.allSettled(t);const o=[];for(let s=0;s<t.length;s++){const a=t[s];a.status==="fulfilled"?o.push(a.value):d.warning({message:"Failed to load product",timeout:3e3,position:"topCenter",color:"red"})}if(o.length===0){d.info({message:"Wishlist is empty",timeout:3e3,position:"topCenter",color:"yellow"}),r.wishProducts.innerHTML="";return}const c=h(o);r.wishProducts.innerHTML=c};export{V as a,K as b,v as c,_ as d,J as e,F as f,W as g,n as h,D as i,U as j,G as k,Y as l,Q as m,L as n,z as o,C as p,r,$ as s};
//# sourceMappingURL=handlers-B510DpBR.js.map
